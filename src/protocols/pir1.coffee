module.exports = (helper) ->
  pulsesToBinaryMapping = {
    '01': '0' #binary 0
    '02': '1' #binary 1
    '03': ''  #footer
  }
  return protocolInfo = {
    name: 'pir1'
    type: 'pir'
    values:
      presence:
        type: "boolean"
    models: []
    pulseLengths: [426, 660, 1653, 17000]
    pulseCount: 50
    decodePulses: (pulses) ->
      # pulses is something like: '02210221022102020221022102210221022102210221020203'
      # we first map: 01 => 0, 02 => 1, 03 => nothing
      # Event detected ...
      # RF receive 406 1637 670 16904 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 408 1653 676 16984 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 438 1651 654 17004 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 433 1653 657 17008 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 433 1652 656 16992 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 432 1654 656 16996 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 441 1651 649 16996 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 432 1653 657 17004 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 434 1653 653 17016 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 430 1652 661 17012 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 433 1653 656 16996 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 430 1654 658 17008 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 434 1653 653 17000 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 430 1653 660 17000 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 427 1653 663 17008 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 432 1653 656 16996 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 432 1653 657 16992 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 432 1653 657 17000 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 430 1654 657 17012 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 415 1654 673 17016 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 375 1651 709 16924 0 0 0 0 01120112011201010112011201120112011201120112010103
      # RF receive 402 1619 666 16568 0 0 0 0 01120112011201010112011201120112011201120112010103
      # Event ended ...
      # RF receive 500 1551 15852 0 0 0 0 0 01100110011001010110011001100110011001100110010102
      # RF receive 465 1421 13848 0 0 0 0 0 01100110011001010110011001100110011001100110010102
      # RF receive 670 2012 22724 0 0 0 0 0 01100110011001010110011001100110011001100110010102

      binary = helper.map(pulses, pulsesToBinaryMapping)
      console.log binary
      # binary is now something like: '000111101000000011101010111100000000'
      return result = {
        presence: helper.binaryToBoolean(binary, 26)
      }
  }
